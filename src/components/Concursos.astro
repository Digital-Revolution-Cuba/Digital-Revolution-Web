---
import Card from './Card.astro';
import cardLogo from '../assets/prueba.avif';

// Configuración del slider de cards
const totalCards = 1; // Número total de cards en el slider
const visibleCards = 3; // Cards visibles a la vez
---

<section id="concursos" class="bg-brand-backgroundGlobal h-auto w-auto">
  <div class="general bg-accent-cyan relative z-30 h-130">
    <!-- Usamos la clase global aquí -->
    <h1 class="heading-impact custom-shadow pt-20 pl-10 drop-shadow-lg">
      Concursos <br /> Activos
    </h1>
    <div class="mx-5 my-2 flex gap-10">
      <Card
        title="Concurso de Fotografía"
        ctaText="Ver Más"
        imageUrl={cardLogo.src}
        altText="Imagen del concurso de fotografía"
        ctaLink="#"
      />
    </div>
  </div>
</section>

<script define:vars={{ totalCards, visibleCards }}>
  document.addEventListener('DOMContentLoaded', () => {
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const slider = document.getElementById('cardSlider');

    if (!prevBtn || !nextBtn || !slider) return;

    let currentIndex = 0;
    const cardsPerPage = 3;
    const itemWidth = 380;
    const maxIndex = Math.max(0, Math.ceil(totalCards / cardsPerPage) - 1);

    function updateSlider() {
      const offset = -currentIndex * cardsPerPage * itemWidth;
      slider.style.transform = `translateX(${offset}px)`;
      prevBtn.disabled = currentIndex <= 0;
      nextBtn.disabled = currentIndex >= maxIndex;
      prevBtn.style.opacity = currentIndex <= 0 ? '0.5' : '1';
      nextBtn.style.opacity = currentIndex >= maxIndex ? '0.5' : '1';
    }

    prevBtn.addEventListener('click', () => {
      if (currentIndex > 0) {
        currentIndex--;
        updateSlider();
      }
    });

    nextBtn.addEventListener('click', () => {
      if (currentIndex < maxIndex) {
        currentIndex++;
        updateSlider();
      }
    });

    updateSlider();
  });
</script>

<style>
  .general {
    clip-path: polygon(0 11%, 100% 0%, 100% 100%, 0 100%);
  }
</style>
